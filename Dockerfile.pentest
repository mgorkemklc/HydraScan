# Dockerfile.pentest

FROM kalilinux/kali-rolling

# Sistem güncellemeleri ve temel araçlar
RUN apt-get update && apt-get install -y \
    python3 python3-pip python3-venv \
    nmap nikto sqlmap whois dnsutils \
    gobuster hydra wapiti \
    curl wget git unzip \
    pciutils net-tools iputils-ping \
    libpcap-dev \
    && rm -rf /var/lib/apt/lists/*

# Go Lang Kurulumu (Nuclei ve Amass için gerekli)
RUN apt-get update && apt-get install -y golang
ENV GOPATH=/root/go
ENV PATH=$PATH:$GOPATH/bin

# --- MODERN PENTEST ARAÇLARI ---

# 1. Nuclei (Zafiyet Tarama Canavarı)
RUN go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

# 2. Subfinder (Subdomain Keşfi)
RUN go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest

# 3. Amass (Derinlemesine Keşif - Opsiyonel, boyutu büyük olabilir)
RUN go install -v github.com/owasp-amass/amass/v3/...@latest

# 4. Dalfox (XSS Tarayıcı)
RUN go install github.com/hahwul/dalfox/v2@latest

# 5. Kiterunner (API Tarayıcı)
RUN curl -L https://github.com/assetnote/kiterunner/releases/download/v1.0.2/kr_linux_amd64.tar.gz -o kr.tar.gz && \
    tar xvf kr.tar.gz && mv kr /usr/local/bin/ && rm kr.tar.gz

# 6. TruffleHog (Gizli Anahtar/Şifre Tarayıcı)
RUN curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin

# Python Araçları
RUN python3 -m venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"
RUN pip install --upgrade pip setuptools wheel
RUN pip install commix

# Çalışma dizini
WORKDIR /app

CMD ["/bin/bash"]